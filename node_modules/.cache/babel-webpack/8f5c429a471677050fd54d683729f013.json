{"ast":null,"code":"// import { AuctionListComponent } from '../auction-list/auction-list.component';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { FunksioneAuction } from '../utils/functions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../auction-storage.service\";\nimport * as i3 from \"../_services\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\n\nfunction AuctionComponent_div_0_div_35_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Your bid is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AuctionComponent_div_0_div_35_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Price must be higher then the current bid. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AuctionComponent_div_0_div_35_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Price must not be higher then your wallet. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AuctionComponent_div_0_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵtemplate(1, AuctionComponent_div_0_div_35_div_1_Template, 2, 0, \"div\", 15);\n    i0.ɵɵtemplate(2, AuctionComponent_div_0_div_35_div_2_Template, 2, 0, \"div\", 15);\n    i0.ɵɵtemplate(3, AuctionComponent_div_0_div_35_div_3_Template, 2, 0, \"div\", 15);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.bid.errors == null ? null : ctx_r2.bid.errors.required);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.bid.errors == null ? null : ctx_r2.bid.errors.min);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.bid.errors == null ? null : ctx_r2.bid.errors.max);\n  }\n}\n\nfunction AuctionComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵelementStart(1, \"div\", 2);\n    i0.ɵɵelementStart(2, \"h5\", 3);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\");\n    i0.ɵɵelementStart(5, \"b\");\n    i0.ɵɵtext(6, \"Created by:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"hr\");\n    i0.ɵɵelementStart(9, \"p\", 4);\n    i0.ɵɵelementStart(10, \"b\");\n    i0.ɵɵtext(11, \"Time Remaining:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\", 4);\n    i0.ɵɵelementStart(14, \"b\");\n    i0.ɵɵtext(15, \"Description:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 5);\n    i0.ɵɵelementStart(18, \"div\", 6);\n    i0.ɵɵelementStart(19, \"p\", 4);\n    i0.ɵɵelementStart(20, \"b\");\n    i0.ɵɵtext(21, \"Current Highest Bid:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"p\");\n    i0.ɵɵtext(23);\n    i0.ɵɵpipe(24, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"div\", 7);\n    i0.ɵɵelementStart(26, \"div\", 8);\n    i0.ɵɵelementStart(27, \"b\");\n    i0.ɵɵtext(28, \"By:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"form\", 9);\n    i0.ɵɵelementStart(31, \"div\", 10);\n    i0.ɵɵelementStart(32, \"fieldset\");\n    i0.ɵɵelementStart(33, \"div\", 8);\n    i0.ɵɵelement(34, \"input\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(35, AuctionComponent_div_0_div_35_Template, 4, 3, \"div\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(36, \"div\", 10);\n    i0.ɵɵelementStart(37, \"fieldset\");\n    i0.ɵɵelementStart(38, \"div\", 8);\n    i0.ɵɵelementStart(39, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function AuctionComponent_div_0_Template_button_click_39_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.save();\n    });\n    i0.ɵɵtext(40, \"Bid !!!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const auction_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(auction_r1.prod_name);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", auction_r1.seller, \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.calculateDiff(auction_r1.prod_date), \" days\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", auction_r1.prod_desc, \"\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(24, 10, auction_r1.prod_highest));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\" \", auction_r1.prod_buyer, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.auctionForm)(\"hidden\", ctx_r0.hideBidButton(auction_r1.seller));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.bid.invalid && (ctx_r0.bid.dirty || ctx_r0.bid.touched));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"disabled\", !ctx_r0.auctionForm.valid);\n  }\n}\n\nexport let AuctionComponent = /*#__PURE__*/(() => {\n  class AuctionComponent extends FunksioneAuction {\n    constructor(routeAuction, storage, accountService) {\n      super();\n      this.routeAuction = routeAuction;\n      this.storage = storage;\n      this.accountService = accountService;\n      this.user = this.accountService.userValue; // this.changeHeader(this.getAuction()[0].prod_name);\n    }\n\n    get bid() {\n      return this.auctionForm.get('bid');\n    }\n\n    ngOnInit() {\n      let walletBuyer;\n\n      if (this.getAuction()[0].prod_buyer !== this.user.firstName) {\n        walletBuyer = this.getWallet();\n      } else {\n        walletBuyer = this.getWallet() + this.getAuction()[0].prod_highest;\n      }\n\n      console.log('walletBuyer ', walletBuyer);\n      const higherBid = this.getAuction()[0].prod_highest + 1;\n      this.auctionForm = new FormGroup({\n        bid: new FormControl('', [Validators.required, Validators.min(higherBid), Validators.max(walletBuyer)])\n      });\n    }\n\n    getAuction() {\n      const id = Number(this.routeAuction.snapshot.paramMap.get('id'));\n      return this.storage.auctionList.filter(x => x.id === id);\n    }\n\n    hideBidButton(seller) {\n      console.log('fsheh ->', this.user.firstName === seller);\n      return this.user.firstName === seller && this.getWallet() < 0;\n    }\n\n    save() {\n      // ndryshimi i user te loguar\n      const users = JSON.parse(localStorage.getItem('users_list'));\n      const singleUser = users.filter(x => x.id === this.user.id);\n      const index = users.indexOf(singleUser[0]);\n      let updatedBuyer;\n\n      if (this.getAuction()[0].prod_buyer !== this.user.firstName) {\n        updatedBuyer = {\n          wallet: users[index].wallet - this.auctionForm.value.bid\n        };\n        console.log('shyqyr qenke ndryshe');\n      } else {\n        updatedBuyer = {\n          wallet: this.getWallet() + this.getAuction()[0].prod_highest - this.auctionForm.value.bid\n        };\n        console.log('mos qenke njesoj');\n      }\n\n      console.log('walletBuyer pas save ', this.getAuction()[0].prod_highest);\n      console.log('prodBuyer pas save ', this.auctionForm.value.bid);\n      console.log('firstName pas save ', this.user.firstName);\n      Object.assign(users[index], updatedBuyer);\n      localStorage.setItem('users_list', JSON.stringify(users)); // ndryshimi i auction\n\n      const updatedAuction = {\n        prod_highest: this.auctionForm.value.bid,\n        prod_buyer: this.user.firstName\n      };\n      this.storage.put(this.getAuction()[0], updatedAuction);\n      this.auctionForm.reset();\n    }\n\n  }\n\n  AuctionComponent.ɵfac = function AuctionComponent_Factory(t) {\n    return new (t || AuctionComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.AuctionStorageService), i0.ɵɵdirectiveInject(i3.AccountService));\n  };\n\n  AuctionComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AuctionComponent,\n    selectors: [[\"app-auction\"]],\n    inputs: {\n      auc_bid: \"auc_bid\"\n    },\n    features: [i0.ɵɵInheritDefinitionFeature],\n    decls: 1,\n    vars: 1,\n    consts: [[\"class\", \"card w-75\", 4, \"ngFor\", \"ngForOf\"], [1, \"card\", \"w-75\"], [1, \"card-body\"], [1, \"card-title\"], [1, \"card-text\"], [1, \"row\"], [1, \"col-md-8\"], [1, \"col-md-4\"], [1, \"col-md-12\", \"mb-3\", \"form-group\"], [\"novalidate\", \"\", 1, \"center-block\", 3, \"formGroup\", \"hidden\"], [1, \"form-row\"], [\"type\", \"number\", \"formControlName\", \"bid\", 1, \"form-control\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [1, \"btn\", \"btn-primary\", 3, \"disabled\", \"click\"], [1, \"alert\", \"alert-danger\"], [4, \"ngIf\"]],\n    template: function AuctionComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, AuctionComponent_div_0_Template, 41, 12, \"div\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngForOf\", ctx.getAuction());\n      }\n    },\n    directives: [i4.NgForOf, i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.FormGroupDirective, i5.NumberValueAccessor, i5.DefaultValueAccessor, i5.NgControlStatus, i5.FormControlName, i4.NgIf],\n    pipes: [i4.CurrencyPipe],\n    styles: [\"\"]\n  });\n  return AuctionComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}